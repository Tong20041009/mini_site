<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>爱心烟花</title>
  <style>
    html, body {
      margin: 0;
      padding: 0;
      overflow: hidden;
      background: #000;
      height: 100%;
    }

    canvas {
      display: block;
    }
  </style>
</head>
<body>
<canvas id="canvas"></canvas>

<script>
const canvas = document.getElementById('canvas');
const ctx = canvas.getContext('2d');
let W = window.innerWidth;
let H = window.innerHeight;
canvas.width = W;
canvas.height = H;

const colors = ["#ff4d6d", "#ff6ec7", "#ff99cc", "#ff3366", "#ff007f", "#ff6699"];

class Heart {
  constructor(x, y, size, color, angle) {
    this.x = x;
    this.y = y;
    this.size = size;
    this.color = color;
    this.angle = angle;
    this.speed = Math.random() * 5 + 2;
    this.alpha = 1;
    this.gravity = 0.1;
  }

  draw() {
    ctx.save();
    ctx.translate(this.x, this.y);
    ctx.rotate(this.angle);
    ctx.scale(this.size / 50, this.size / 50);
    ctx.beginPath();
    ctx.moveTo(0, 0);
    ctx.bezierCurveTo(0, -3, -3, -3, -3, 0);
    ctx.bezierCurveTo(-3, 3, 0, 5, 0, 8);
    ctx.bezierCurveTo(0, 5, 3, 3, 3, 0);
    ctx.bezierCurveTo(3, -3, 0, -3, 0, 0);
    ctx.fillStyle = this.color;
    ctx.globalAlpha = this.alpha;
    ctx.fill();
    ctx.restore();
  }

  update() {
    this.x += Math.cos(this.angle) * this.speed;
    this.y += Math.sin(this.angle) * this.speed + this.gravity;
    this.alpha -= 0.02;
  }
}

let hearts = [];

function createExplosion(x, y) {
  for (let i = 0; i < 60; i++) {
    let angle = Math.random() * Math.PI * 2;
    let size = Math.random() * 14 + 8;
    let color = colors[Math.floor(Math.random() * colors.length)];
    hearts.push(new Heart(x, y, size, color, angle));
  }
}

canvas.addEventListener("click", (e) => {
  createExplosion(e.clientX, e.clientY);
});

function animate() {
  ctx.clearRect(0, 0, W, H);
  hearts = hearts.filter((h) => h.alpha > 0);
  hearts.forEach((heart) => {
    heart.update();
    heart.draw();
  });
  requestAnimationFrame(animate);
}

animate();

window.addEventListener("resize", () => {
  W = window.innerWidth;
  H = window.innerHeight;
  canvas.width = W;
  canvas.height = H;
});

// 自动随机烟花
setInterval(() => {
  createExplosion(Math.random() * W, Math.random() * H * 0.6);
}, 800);
</script>
</body>
</html>